<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Wifi Password Generator</title>
    </head>
    <style>  
    html,body{  
        margin:0px;  
        height:100%;  
    }  
    #screen{  
        width:100%;  
        height:100%;  
        MARGIN: 0px auto;  
        background-color:black;  
        text-align:center;
        vertical-align:middle;    
    }  

    .dark {
        background: black;
     }
    </style> 
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <SCRIPT type="text/javascript">

    var bg = 1;
    var dhigh= 100 ;
    var d0 = 100;
    var d1 = 200 ;
    var delays = new Array();
    /*delays.push(1000);
    delays.push(1000);
    delays.push(100);
    delays.push(100);
    delays.push(100);
    delays.push(100);*/
    

    function light()
    {
        $("#screen").css({'background-color': '#FFF'});
    }
    function dark()
    {
        $("#screen").css({'background-color': '#000'});
    }
    function blink()
    {
        if (bg) {
            bg = 0;
            light();
        }
        else
        {
            bg = 1;
            dark();
        }
        var d = delays.shift();
        if (d != undefined) {
            setTimeout(blink, d);
        }else
        {
            dark();
            $("#go").val("Send");
        }
        
    }
    function send()
    {
        var text = $("#password").val().trim();
        if (text.length < 1) {
            return;
        }
        dark();
        //preamble
        delays.push(1000);
        delays.push(1000);
        //data
        $.each(text, function(i,v){
            var bin = text.charCodeAt(i).toString(2);
            var prefix = "";
            var i;
            if (bin.length < 8) {
                for (i=0;i<(8-bin.length);i++) {
                    prefix += "0";
                }
                bin = prefix.concat(bin);
            }
            var sum=false;
            for (i=0;i<8;i++) {
                delays.push(dhigh);
                if (bin[i] == '0')
                {
                    sum ^= false;
                    delays.push(d0);
                }
                else
                {
                    sum ^= true;
                    delays.push(d1);
                }
            }
            delays.push(dhigh);
            if (sum) {
                delays.push(d1);
            }else
            {
                delays.push(d0);
            }
            
        });
        delays.push(2000);

        //blink now
        bg = 1;
        setTimeout(blink, 3000);
    }

    function clicked()
    {
        if ($("#go").val() == "Send") {
            $("#go").val("Stop");
            send();
        }else
        {
            $("#go").val("Send");
            location.reload();
        }
    }

    </SCRIPT>
    
    <body>
    
    <div id="screen">
        <form>
        <input id="password" type="text"  style="width:50%;height:100px;font-size: 5em" />
        <input id="go" type="button" value="Send" style="width:20%;height:100px;font-size: 5em" onclick="clicked()" />
        </form>
    </div>

    </body>
</html>
